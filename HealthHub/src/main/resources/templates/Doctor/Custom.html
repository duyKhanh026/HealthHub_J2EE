<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Thiết kế tranh chính</title>

  <!-- Custom fonts for this template -->
  <link th:href="@{assets2/vendor/fontawesome-free/css/all.min.css}" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link th:href="@{assets2/css/sb-admin-2.min.css}" rel="stylesheet">
  <link th:href="@{assets2/vendor/datatables/dataTables.bootstrap4.min.css}" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
  <!-- Favicons -->
  <link th:href="@{assets/img/favicon.png}" rel="icon">
  <link th:href="@{assets/img/apple-touch-icon.png}" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link th:href="@{assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
  <link th:href="@{assets/vendor/bootstrap-icons/bootstrap-icons.css}" rel="stylesheet">
  <link th:href="@{assets/vendor/aos/aos.css}" rel="stylesheet">
  <link th:href="@{assets/vendor/fontawesome-free/css/all.min.css}" rel="stylesheet">
  <link th:href="@{assets/vendor/glightbox/css/glightbox.min.css}" rel="stylesheet">
  <link th:href="@{assets/vendor/swiper/swiper-bundle.min.css}" rel="stylesheet">

  <!-- Main CSS File -->
  <link th:href="@{assets/css/main.css}" rel="stylesheet">

</head>

<body id="page-top">
<!-- Page Wrapper -->
<div id="wrapper">
<div style="position: fixed;width: 18%;">

	<th:block th:replace="~{Doctor/menu :: menuFragment}"></th:block>
</div>

  <!-- Content Wrapper -->
  <div id="content-wrapper" class="d-flex flex-column">
    <!-- Main Content -->
    <div id="content" style="padding-left: 12%;">
		<header id="header" class="header sticky-top" xmlns:sec="http://www.w3.org/1999/xhtml" th:fragment="headerFragment"
		        xmlns:th="http://www.w3.org/1999/xhtml">

		    <div class="topbar d-flex align-items-center">
		        <div class="container d-flex justify-content-center justify-content-md-between">
		            <div class="contact-info d-flex align-items-center">
		                <i class="bi bi-envelope d-flex align-items-center"><a><input id="txtemail" type="text" th:value="${page.email}"></a></i>
		                <i class="bi bi-phone d-flex align-items-center ms-4"><span><input id="txtphone" type="text" th:value="${page.phone}"></span></i>
		            </div>
		            <div class="social-links d-none d-md-flex align-items-center">
		                <a href="#" class="twitter"><i class="bi bi-twitter-x"></i></a>
		                <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
		                <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
		                <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
		            </div>
		        </div>
		    </div><!-- End Top Bar -->

		    <div class="branding d-flex align-items-center">

		        <div class="container position-relative d-flex align-items-center justify-content-between">
		            <a class="logo d-flex align-items-center me-auto">
		                <!-- Uncomment the line below if you also wish to use an image logo -->
		                <!-- <img th:src="@{assets/img/logo.png}" alt=""> -->
						<input id="txtpagename" type="text" th:value="${page.pageName}">
		            </a>

		            <nav id="navmenu" class="navmenu">
		                
		                <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
		            </nav>

					<button class="btn btn-primary" id="updatebtn">Update</button>


		            <!-- Modal Xác Nhận Đăng Xuất -->
		            <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="logoutModalLabel" aria-hidden="true">
		                <div class="modal-dialog" role="document">
		                    <div class="modal-content">
		                        <div class="modal-header">
		                            <h5 class="modal-title" id="logoutModalLabel">Xác Nhận Đăng Xuất</h5>
		                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		                        </div>
		                        <div class="modal-body">
		                            Bạn có chắc chắn muốn đăng xuất không?
		                        </div>
		                        <div class="modal-footer">
		                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
		                            <form th:action="@{/logout}" style="display: inline;">
		                                <input type="submit" class="btn btn-danger" value="Đăng xuất"/>
		                            </form>
		                        </div>
		                    </div>
		                </div>
		            </div>

		        </div>

		    </div>


		</header>


		<main class="main">

		    <!-- Hero Section -->
		    <section id="hero" class="hero section light-background">
				<img th:src="'data:image/png;base64,' + ${base64Image2}" alt="" data-aos="fade-in">

		        <div class="container position-relative">

					<input id="imgbyte2" type="file" name="image" accept="image/*" required>
		            <div class="welcome position-relative" data-aos="fade-down" data-aos-delay="100">
		                <h2><input id="txtwelcome" type="text" th:value="${page.welcomeLine}"></h2>
						<textarea id="txtwelcome1" style="width: 600px; height: 30%;" th:text="${page.welcomeLine1}"></textarea>
		            </div><!-- End Welcome -->

		            <div class="content row gy-4">
		                <div class="col-lg-4 d-flex align-items-stretch">
		                    <div class="why-box" data-aos="zoom-out" style="width: 100%;">
		                        <h3 ><input id="txtbox1_1" th:value="${page.box1_1}"  style="width: 100%;"></h3>
		                       <textarea id="txtbox1_2" style="width: 100%; height: 50%;" th:text="${page.box1_2}"></textarea>
		                        
		                    </div>
		                </div><!-- End Why Box -->
 
		                <div class="col-lg-8 d-flex align-items-stretch">
		                    <div class="d-flex flex-column justify-content-center">
		                        <div class="row gy-4">

		                            <div class="col-xl-4 d-flex align-items-stretch" style="width: 350px;">
		                                <div class="icon-box" data-aos="zoom-out" data-aos-delay="300">
		                                    <i class="bi bi-clipboard-data"></i>
											<button class="btn btn-primary" onclick="addRow()">Add</button>
											<button class="btn btn-primary" onclick="saveChanges()">Edit</button>
		                                    <h4><input id="boxName"></h4>
											<textarea id="boxContent" style="width: 100%; height: 50%;" ></textarea>
		                                </div>
		                            </div><!-- End Icon Box -->

		                        </div>
		                    </div>
							
		                </div>
		            </div><!-- End  Content-->
					<br>
					<table id="dataTable" style="border: 1px solid black; width: 100%; background-color: white;">
				        <thead>
				            <tr>
				                <th>id_b</th>
				                <th>boxName</th>
				                <th>boxContent</th>
				            </tr>
				        </thead>
				        <tbody>
				            <tr th:each="pp : ${page_1}">
				                <td th:text="${pp.id_b}">1</td>
				                <td th:text="${pp.boxName}"></td>
								<td th:text="${pp.boxContent}"></td>
								<td>
				                    <button class="add-btn" onclick="editRow(this)">Edit</button>
				                    <button class="remove-btn" onclick="removeRow(this)" >Del</button>
				                </td>
				            </tr>
				        </tbody>
				    </table>
					<script>
						
						
						let currentRow = null;
						
						function addRow() {
				            // Lấy giá trị từ form
							const boxName = document.getElementById('boxName').value;
							const boxContent = document.getElementById('boxContent').value;

				            if (!boxName || !boxContent) {
				                alert('Please fill in all fields before adding a row.');
				                return;
				            }

				            // Tạo hàng mới
				            const table = document.querySelector('table tbody');
				            const newRow = document.createElement('tr');
				            newRow.innerHTML = `
				                <td></td>
				                <td>${boxName}</td>
				                <td>${boxContent}</td>
				                <td>
				                    <button class="edit-btn" onclick="editRow(this)">Edit</button>
				                    <button class="remove-btn" onclick="removeRow(this)" >Del</button>
				                </td>
				            `;

				            // Thêm hàng vào bảng
				            table.appendChild(newRow);
				            updateRowNumbers();

				            // Xóa form sau khi thêm
				            document.getElementById('boxName').value = '';
				            document.getElementById('boxContent').value = '';
				        }

				        function updateRowNumbers() {
				            const rows = document.querySelectorAll('table tbody tr');
				            rows.forEach((row, index) => {
				                row.cells[0].innerText = index + 1;
				            });
				        }
						
						function editRow(button) {
				            // Lấy dòng hiện tại
				            const row = button.closest('tr');
				            currentRow = row;

				            // Lấy dữ liệu từ dòng
				            const boxName = row.cells[1].innerText;
				            const boxContent = row.cells[2].innerText;

				            // Đổ dữ liệu lên form
				            document.getElementById('boxName').value = boxName;
				            document.getElementById('boxContent').value = boxContent;
				        }
						function saveChanges() {
				            if (!currentRow) return;

				            const boxName = document.getElementById('boxName').value;
				            const boxContent = document.getElementById('boxContent').value;

				            currentRow.cells[1].innerText = boxName;
				            currentRow.cells[2].innerText = boxContent;

				            currentRow = null;
				        }
						function removeRow(button) {
				            if (confirm('Are you sure you want to remove this row?')) {
				                const row = button.closest('tr');
				                row.remove();
				            }
				        }
					</script>
		        </div>							
				
		    </section><!-- /Hero Section -->

		    <!-- About Section -->
		    <section id="about" class="about section">
		        <div class="container">
		            <div class="row gy-4 gx-5">
		                <div class="col-lg-6 position-relative align-self-start" data-aos="fade-up" data-aos-delay="200">
		                    <img th:src="'data:image/png;base64,' + ${base64Image}" class="img-fluid" alt="">
							<input id="imgbyte" type="file" name="image" accept="image/*" required>
							<input id="txtytburl" type="text" th:value="${page.ytburl}" style="width: 100%;">
		                    <a th:href="${page.ytburl}" class="glightbox pulsating-play-btn"></a>
		                </div>

		                <div class="col-lg-6 content" data-aos="fade-up" data-aos-delay="100">
		                    <h3>About Us</h3>
								<textarea id="txtabout_us" th:text="${page.about_us}" style="width: 100%;height: 100%;"></textarea>
		                    <ul>
		                    </ul>
		                </div>
		            </div>
		        </div>
		    </section><!-- /About Section -->

			
			<section id="contact" class="contact section">
			    <!-- Section Title 
			    <div class="container section-title" data-aos="fade-up">
			      <h2>Contact</h2>
			      <p>Necessitatibus eius consequatur ex aliquid fuga eum quidem sint consectetur velit</p>
			    </div> End Section Title -->

			    <div class="container aos-init aos-animate" data-aos="fade-up" data-aos-delay="200">

					<div class="container section-title aos-init aos-animate" data-aos="fade-up">
					    <h2>Xem Đường</h2>
				  
			    	</div>

			    <div class="container" data-aos="fade-up" data-aos-delay="100">
			      <div class="row gy-4">
			        <div class="col-lg-4">
			          <div class="info-item d-flex" data-aos="fade-up" data-aos-delay="300">
			            <i class="bi bi-geo-alt flex-shrink-0"></i>
			            <div  style="width: 100%;">
			              <h3>Location</h3>
			              <p ><input id="txtLocation" th:value="${page.Location}" style="width: 100%;"></p>
			            </div>
			          </div><!-- End Info Item -->

			        </div>
			      </div>
			    </div>

			  </section><!-- /Contact Section -->

		    

		</main>

		<th:block th:replace="footer :: footerFragment"></th:block>
		<script>
			document.getElementById('updatebtn').addEventListener('click', function() {
	            // Lấy giá trị của các input
	            var temail    = document.getElementById('txtemail').value;
	            var tphone    = document.getElementById('txtphone').value;
				var tpagename = document.getElementById('txtpagename').value;
				var twelcome  = document.getElementById('txtwelcome').value;
				var twelcome1 = document.getElementById('txtwelcome1').value;
				var tbox1_1   = document.getElementById('txtbox1_1').value;
				var tbox1_2   = document.getElementById('txtbox1_2').value;
				var tabout_us   = document.getElementById('txtabout_us').value;
				var tLocation   = document.getElementById('txtLocation').value;
				var tytburl   = document.getElementById('txtytburl').value;
				
				const imgInput = document.getElementById("imgbyte");
				const imgInput2 = document.getElementById("imgbyte2");

			    // Kiểm tra xem có file được chọn hay không
			    if (!imgInput.files || imgInput.files.length === 0) {
			        alert("Vui lòng chọn một ảnh.");
			        return;
			    }

			    // Lấy file từ input
			    const file = imgInput.files[0];
				const file2 = imgInput2.files[0];

				var table = document.getElementById('dataTable');
				var tableData = [];

			    // Duyệt qua các dòng của bảng (bỏ qua dòng tiêu đề)
			    for (var i = 1, row; row = table.rows[i]; i++) {
			        var rowData = {
			            id_b: row.cells[0].innerText,
			            boxName: row.cells[1].innerText,
						boxContent: row.cells[2].innerText
			        };
			        tableData.push(rowData);
			    }
				
				var data = {
			        pageCustomIndex: {
						id: 0,
				        email: temail,
				        phone: tphone,
				        pageName: tpagename,
				        welcomeLine: twelcome,
				        welcomeLine1: twelcome1,
				        box1_1: tbox1_1,
				        box1_2: tbox1_2,
				        about_us: tabout_us,
				        location: tLocation,
						ytburl: tytburl,
						imgdata: null,
						imgdata2: null
			        },
			        pageCustomIndex_1: tableData
			    };
				
				
				
				const formData = new FormData();
				formData.append("file", file); // File ảnh
				formData.append("file2", file2); // File ảnh
				formData.append("data", JSON.stringify(data)); // Dữ liệu JSON

				fetch('/Custom', {
				    method: 'POST',
				    body: formData,
				})
				.then(response => {
				    // Kiểm tra nếu response trả về status code 200
				    if (!response.ok) {
				        throw new Error('Network response was not ok');
				    }
				    return response.json(); // Chuyển phản hồi thành JSON
				})
				.then(data => {
					location.reload();
				})
				.catch((error) => {
					location.reload();
				});

	        });
		</script>

		<!-- Scroll Top -->
		<a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

		<!-- Preloader -->
		<div id="preloader"></div>

		<!-- Vendor JS Files -->
		<script th:src="@{assets/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
		<script th:src="@{assets/vendor/php-email-form/validate.js}"></script>
		<script th:src="@{assets/vendor/aos/aos.js}"></script>
		<script th:src="@{assets/vendor/glightbox/js/glightbox.min.js}"></script>
		<script th:src="@{assets/vendor/purecounter/purecounter_vanilla.js}"></script>
		<script th:src="@{assets/vendor/swiper/swiper-bundle.min.js}"></script>

		<!-- Main JS File -->
		<script th:src="@{assets/js/main.js}"></script>
	</div>
  </div>
</div>

<!-- Bootstrap core JavaScript-->
<script src="assets2/vendor/jquery/jquery.min.js"></script>
<script src="assets2/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets2/vendor/jquery-easing/jquery.easing.min.js"></script>
<script src="assets2/js/sb-admin-2.min.js"></script>
</body>

</html>
